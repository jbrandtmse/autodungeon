<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>autodungeon - Final Design Direction</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           CSS VARIABLES - Design Foundation
           ======================================== */
        :root {
            /* Background Colors */
            --bg-primary: #1A1612;
            --bg-secondary: #2D2520;
            --bg-message: #3D3530;
            --bg-hover: #4D4540;

            /* Text Colors */
            --text-primary: #F5E6D3;
            --text-secondary: #B8A896;
            --text-muted: #8A7A68;

            /* Accent Colors */
            --accent-warm: #E8A849;
            --accent-warm-dim: rgba(232, 168, 73, 0.2);

            /* Character Colors */
            --color-dm: #D4A574;
            --color-fighter: #C45C4A;
            --color-rogue: #6B8E6B;
            --color-wizard: #7B68B8;
            --color-cleric: #4A90A4;

            /* Semantic Colors */
            --color-success: #6B8E6B;
            --color-warning: #E8A849;
            --color-error: #C45C4A;
            --color-info: #4A90A4;

            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;

            /* Typography */
            --font-narrative: 'Lora', Georgia, serif;
            --font-ui: 'Inter', system-ui, sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            /* Layout */
            --sidebar-width: 240px;
            --max-content-width: 800px;
            --header-height: 56px;
        }

        /* ========================================
           RESET & BASE STYLES
           ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-ui);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ========================================
           NAVIGATION
           ======================================== */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--bg-message);
            padding: var(--space-sm) var(--space-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
        }

        .top-nav h1 {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-warm);
        }

        .top-nav .subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .view-tabs {
            display: flex;
            gap: var(--space-xs);
        }

        .view-tab {
            padding: var(--space-sm) var(--space-md);
            background: transparent;
            border: 1px solid var(--bg-message);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .view-tab:hover {
            background: var(--bg-message);
            color: var(--text-primary);
        }

        .view-tab.active {
            background: var(--accent-warm);
            border-color: var(--accent-warm);
            color: var(--bg-primary);
        }

        /* ========================================
           MAIN LAYOUT - Sidebar + Manuscript
           ======================================== */
        .app-container {
            margin-top: 52px;
            display: grid;
            grid-template-columns: var(--sidebar-width) 1fr;
            min-height: calc(100vh - 52px);
        }

        /* ========================================
           SIDEBAR (from Direction 1)
           ======================================== */
        .sidebar {
            background: var(--bg-secondary);
            border-right: 1px solid var(--bg-message);
            display: flex;
            flex-direction: column;
            height: calc(100vh - 52px);
            position: sticky;
            top: 52px;
        }

        .sidebar-header {
            padding: var(--space-md);
            border-bottom: 1px solid var(--bg-message);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sidebar-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mode-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .mode-indicator.watch {
            background: var(--accent-warm-dim);
            color: var(--accent-warm);
        }

        .mode-indicator.play {
            background: rgba(107, 142, 107, 0.2);
            color: var(--color-success);
        }

        .mode-indicator .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .party-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-md);
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .party-member {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm);
            border-radius: 8px;
            transition: background 0.2s ease;
            cursor: default;
        }

        .party-member:hover {
            background: var(--bg-message);
        }

        .party-member.active {
            background: var(--bg-message);
            border: 1px solid var(--accent-warm);
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .avatar.dm { background: var(--color-dm); color: var(--bg-primary); }
        .avatar.fighter { background: var(--color-fighter); color: var(--text-primary); }
        .avatar.rogue { background: var(--color-rogue); color: var(--text-primary); }
        .avatar.wizard { background: var(--color-wizard); color: var(--text-primary); }
        .avatar.cleric { background: var(--color-cleric); color: var(--text-primary); }

        .party-member .info {
            flex: 1;
            min-width: 0;
        }

        .party-member .char-name {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .party-member .char-class {
            font-size: 12px;
            color: var(--text-muted);
        }

        .drop-in-btn {
            padding: var(--space-xs) var(--space-sm);
            background: transparent;
            border: 1px solid currentColor;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            opacity: 0.6;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .drop-in-btn:hover {
            opacity: 1;
            background: currentColor;
        }

        .drop-in-btn:hover span {
            color: var(--bg-primary);
        }

        .drop-in-btn.fighter { color: var(--color-fighter); }
        .drop-in-btn.rogue { color: var(--color-rogue); }
        .drop-in-btn.wizard { color: var(--color-wizard); }
        .drop-in-btn.cleric { color: var(--color-cleric); }

        .sidebar-footer {
            padding: var(--space-md);
            border-top: 1px solid var(--bg-message);
        }

        .session-info {
            font-size: 12px;
            color: var(--text-muted);
        }

        .session-info .label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .session-info .value {
            color: var(--text-secondary);
        }

        /* ========================================
           MAIN AREA - Manuscript Style (from Direction 5)
           ======================================== */
        .main-area {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 52px);
            background:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.02'/%3E%3C/svg%3E"),
                var(--bg-primary);
        }

        .main-header {
            padding: var(--space-lg) var(--space-xl);
            text-align: center;
            border-bottom: 1px solid var(--bg-message);
        }

        .main-header h2 {
            font-family: var(--font-narrative);
            font-size: 24px;
            font-weight: 600;
            color: var(--color-dm);
            margin-bottom: var(--space-xs);
        }

        .main-header .subtitle {
            font-size: 13px;
            color: var(--text-muted);
            font-style: italic;
        }

        .manuscript {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-xl) var(--space-2xl);
            max-width: var(--max-content-width);
            margin: 0 auto;
            width: 100%;
        }

        /* Message Styling - Manuscript */
        .message {
            margin-bottom: var(--space-lg);
            font-family: var(--font-narrative);
        }

        .message .attribution {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: var(--space-xs);
            font-family: var(--font-ui);
        }

        .message .content {
            font-size: 17px;
            line-height: 1.7;
            text-align: justify;
            hyphens: auto;
        }

        .message .content em {
            color: var(--text-secondary);
        }

        /* DM Message - Special Treatment */
        .message.dm {
            padding: var(--space-lg);
            background: rgba(212, 165, 116, 0.08);
            border-radius: 4px;
            margin: var(--space-xl) 0;
            position: relative;
            border-left: 3px solid var(--color-dm);
        }

        .message.dm .attribution {
            color: var(--color-dm);
            font-style: italic;
        }

        .message.dm .content {
            font-size: 18px;
            font-style: italic;
            text-align: left;
        }

        /* Character Messages */
        .message.fighter .attribution { color: var(--color-fighter); }
        .message.rogue .attribution { color: var(--color-rogue); }
        .message.wizard .attribution { color: var(--color-wizard); }
        .message.cleric .attribution { color: var(--color-cleric); }

        /* Input Area */
        .input-area {
            padding: var(--space-md) var(--space-xl);
            border-top: 1px solid var(--bg-message);
            background: var(--bg-secondary);
        }

        .input-area.hidden {
            display: none;
        }

        .input-area.active {
            display: block;
        }

        .input-context {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--space-sm);
            padding: var(--space-sm);
            background: var(--bg-message);
            border-radius: 4px;
        }

        .input-context strong {
            color: var(--color-fighter);
        }

        .input-row {
            display: flex;
            gap: var(--space-sm);
        }

        .input-field {
            flex: 1;
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-primary);
            border: 1px solid var(--bg-message);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: var(--font-narrative);
            font-size: 16px;
            resize: none;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-warm);
            box-shadow: 0 0 0 2px var(--accent-warm-dim);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .send-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--accent-warm);
            border: none;
            border-radius: 6px;
            color: var(--bg-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            background: #F0B85A;
        }

        .release-btn {
            padding: var(--space-sm) var(--space-md);
            background: transparent;
            border: 1px solid var(--text-muted);
            border-radius: 6px;
            color: var(--text-muted);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .release-btn:hover {
            border-color: var(--text-secondary);
            color: var(--text-secondary);
        }

        /* ========================================
           VIEW: WATCH MODE (default)
           ======================================== */
        .view-watch .input-area {
            display: none;
        }

        /* ========================================
           VIEW: PLAY MODE
           ======================================== */
        .view-play .input-area {
            display: block;
        }

        .view-play .mode-indicator.watch {
            display: none;
        }

        .view-play .mode-indicator.play {
            display: inline-flex;
        }

        /* ========================================
           DESIGN NOTES PANEL
           ======================================== */
        .notes-panel {
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            background: var(--bg-secondary);
            border: 1px solid var(--bg-message);
            border-radius: 8px;
            padding: var(--space-md);
            max-width: 320px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            z-index: 100;
        }

        .notes-panel h3 {
            font-size: 12px;
            font-weight: 600;
            color: var(--accent-warm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: var(--space-sm);
        }

        .notes-panel ul {
            list-style: none;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .notes-panel li {
            padding: var(--space-xs) 0;
            border-bottom: 1px solid var(--bg-message);
        }

        .notes-panel li:last-child {
            border-bottom: none;
        }

        .notes-panel .highlight {
            color: var(--accent-warm);
            font-weight: 500;
        }

        .close-notes {
            position: absolute;
            top: var(--space-sm);
            right: var(--space-sm);
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 16px;
        }

        .close-notes:hover {
            color: var(--text-primary);
        }

        /* Hide on smaller screens */
        @media (max-width: 1200px) {
            .notes-panel {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="top-nav">
        <div>
            <h1>autodungeon</h1>
            <span class="subtitle">Final Design Direction: Sidebar + Manuscript</span>
        </div>
        <div class="view-tabs">
            <button class="view-tab active" data-view="watch">Watch Mode</button>
            <button class="view-tab" data-view="play">Play Mode</button>
        </div>
    </nav>

    <!-- Main Application -->
    <div class="app-container view-watch" id="app">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <span class="sidebar-title">Party</span>
                <span class="mode-indicator watch"><span class="dot"></span> Watching</span>
                <span class="mode-indicator play" style="display: none;"><span class="dot"></span> Playing</span>
            </div>

            <div class="party-list">
                <div class="party-member" id="member-fighter">
                    <div class="avatar fighter">Th</div>
                    <div class="info">
                        <div class="char-name" style="color: var(--color-fighter)">Theron</div>
                        <div class="char-class">Human Fighter</div>
                    </div>
                    <button class="drop-in-btn fighter" onclick="dropIn('fighter', 'Theron')"><span>Drop In</span></button>
                </div>

                <div class="party-member">
                    <div class="avatar rogue">Si</div>
                    <div class="info">
                        <div class="char-name" style="color: var(--color-rogue)">Silka</div>
                        <div class="char-class">Halfling Rogue</div>
                    </div>
                    <button class="drop-in-btn rogue" onclick="dropIn('rogue', 'Silka')"><span>Drop In</span></button>
                </div>

                <div class="party-member">
                    <div class="avatar wizard">Ma</div>
                    <div class="info">
                        <div class="char-name" style="color: var(--color-wizard)">Maelis</div>
                        <div class="char-class">Elf Wizard</div>
                    </div>
                    <button class="drop-in-btn wizard" onclick="dropIn('wizard', 'Maelis')"><span>Drop In</span></button>
                </div>

                <div class="party-member">
                    <div class="avatar cleric">Br</div>
                    <div class="info">
                        <div class="char-name" style="color: var(--color-cleric)">Brother Aldric</div>
                        <div class="char-class">Dwarf Cleric</div>
                    </div>
                    <button class="drop-in-btn cleric" onclick="dropIn('cleric', 'Brother Aldric')"><span>Drop In</span></button>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="session-info">
                    <div class="label">Current Session</div>
                    <div class="value">The Sunken Temple</div>
                    <div style="font-size: 11px; color: var(--text-muted); margin-top: 4px;">Session VII &bull; 2h 14m</div>
                </div>
            </div>
        </aside>

        <!-- Main Content - Manuscript Style -->
        <main class="main-area">
            <header class="main-header">
                <h2>The Sunken Temple</h2>
                <div class="subtitle">Session VII &bull; A Chronicle of Adventure</div>
            </header>

            <div class="manuscript">
                <div class="message dm">
                    <div class="attribution">The Dungeon Master speaks:</div>
                    <div class="content">The ancient door groans open, releasing a breath of stale air that carries the scent of moss and something older - something that hasn't seen light in centuries. Beyond, torchlight catches on water-slicked stone steps descending into darkness. The carvings on the walls seem to shift in the flickering light, telling stories in a language long forgotten.</div>
                </div>

                <div class="message fighter">
                    <div class="attribution">Theron, the Fighter:</div>
                    <div class="content">"I'll take point," <em>he declares, drawing his longsword. The blade catches the torchlight as he steps forward, shield raised.</em> "Stay close. And Silka - maybe don't touch anything shiny until we know what we're dealing with?"</div>
                </div>

                <div class="message rogue">
                    <div class="attribution">Silka, the Rogue:</div>
                    <div class="content"><em>She grins, already eyeing the carved reliefs on the walls with an appraiser's eye.</em> "No promises, big guy. But I'll check for traps first. Probably." <em>Her fingers dance across her belt, finding the familiar weight of her lockpicks.</em></div>
                </div>

                <div class="message wizard">
                    <div class="attribution">Maelis, the Wizard:</div>
                    <div class="content"><em>She murmurs an incantation, and four dancing lights spring to life around her staff, casting long shadows down the corridor.</em> "These carvings... this is Old Elvish. Pre-Sundering. We may be the first to walk these halls in three thousand years." <em>Her voice carries a reverence that silences the others for a moment.</em></div>
                </div>

                <div class="message cleric">
                    <div class="attribution">Brother Aldric, the Cleric:</div>
                    <div class="content">"Then let us tread carefully and with respect," <em>the dwarf intones, touching the holy symbol at his chest. The silver gleams briefly in Maelis's magical light.</em> "The old powers do not take kindly to grave robbers. We seek knowledge, not plunder - let us hope the spirits of this place understand the difference."</div>
                </div>

                <div class="message dm">
                    <div class="attribution">The Dungeon Master speaks:</div>
                    <div class="content">As if in response to Aldric's words, a distant sound echoes from somewhere deep below - the grinding of stone against stone, followed by silence. The dancing lights flicker, though there is no wind. Something stirs in the depths of the Sunken Temple, awakened perhaps by voices that have not been heard in millennia.</div>
                </div>

                <div class="message fighter">
                    <div class="attribution">Theron, the Fighter:</div>
                    <div class="content"><em>His grip tightens on his sword.</em> "Well. That's not ominous at all." <em>Despite his dry tone, there's a gleam in his eye - the look of a man who's been waiting for exactly this kind of adventure.</em> "Shall we?"</div>
                </div>
            </div>

            <!-- Input Area (visible in Play Mode) -->
            <div class="input-area" id="input-area">
                <div class="input-context">
                    You are <strong id="playing-as">Theron, the Fighter</strong>. The party stands at the entrance to ancient stairs descending into darkness.
                </div>
                <div class="input-row">
                    <textarea class="input-field" placeholder="What do you do?" rows="2"></textarea>
                    <button class="send-btn">Send</button>
                    <button class="release-btn" onclick="releaseControl()">Release</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Design Notes -->
    <div class="notes-panel" id="notes">
        <button class="close-notes" onclick="document.getElementById('notes').style.display='none'">&times;</button>
        <h3>Design Direction</h3>
        <ul>
            <li><span class="highlight">Sidebar</span> from Direction 1 - Party panel always visible</li>
            <li><span class="highlight">Manuscript</span> from Direction 5 - Literary narrative feel</li>
            <li><span class="highlight">Attribution</span> - "Name, the Class:" format</li>
            <li><span class="highlight">DM styling</span> - Gold accent, italic, special block</li>
            <li><span class="highlight">Typography</span> - Lora serif for all narrative</li>
            <li>Toggle <strong>Watch/Play</strong> tabs above to see modes</li>
        </ul>
    </div>

    <script>
        // View switching
        document.querySelectorAll('.view-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                const view = tab.dataset.view;
                const app = document.getElementById('app');
                app.classList.remove('view-watch', 'view-play');
                app.classList.add(`view-${view}`);

                // Update mode indicators
                document.querySelectorAll('.mode-indicator.watch').forEach(el => {
                    el.style.display = view === 'watch' ? 'inline-flex' : 'none';
                });
                document.querySelectorAll('.mode-indicator.play').forEach(el => {
                    el.style.display = view === 'play' ? 'inline-flex' : 'none';
                });

                // Show/hide input
                const input = document.getElementById('input-area');
                input.style.display = view === 'play' ? 'block' : 'none';
            });
        });

        // Drop-in functionality
        function dropIn(charClass, charName) {
            // Switch to play mode
            document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-view="play"]').classList.add('active');

            const app = document.getElementById('app');
            app.classList.remove('view-watch');
            app.classList.add('view-play');

            // Update context
            document.getElementById('playing-as').textContent = charName;
            document.getElementById('playing-as').style.color = `var(--color-${charClass})`;

            // Show input
            document.getElementById('input-area').style.display = 'block';

            // Update mode indicators
            document.querySelectorAll('.mode-indicator.watch').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.mode-indicator.play').forEach(el => el.style.display = 'inline-flex');

            // Highlight active member
            document.querySelectorAll('.party-member').forEach(m => m.classList.remove('active'));
            document.getElementById(`member-${charClass}`)?.classList.add('active');
        }

        // Release control
        function releaseControl() {
            document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-view="watch"]').classList.add('active');

            const app = document.getElementById('app');
            app.classList.remove('view-play');
            app.classList.add('view-watch');

            document.getElementById('input-area').style.display = 'none';

            document.querySelectorAll('.mode-indicator.watch').forEach(el => el.style.display = 'inline-flex');
            document.querySelectorAll('.mode-indicator.play').forEach(el => el.style.display = 'none');

            document.querySelectorAll('.party-member').forEach(m => m.classList.remove('active'));
        }
    </script>
</body>
</html>